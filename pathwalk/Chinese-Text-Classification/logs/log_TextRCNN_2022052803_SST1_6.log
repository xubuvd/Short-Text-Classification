model               : TextRCNN
embedding           : random
dataset             : SST1
word                : True
pad                 : 20
<models.TextRCNN.Config object at 0x7f92794fcf90>
Loading data...
0it [00:00, ?it/s]8544it [00:00, 241447.58it/s]
Vocab size: 3553
0it [00:00, ?it/s]8544it [00:00, 162039.34it/s]
0it [00:00, ?it/s]1101it [00:00, 162591.67it/s]
0it [00:00, ?it/s]2210it [00:00, 161735.97it/s]
/home/pangwei/.conda/envs/vd/lib/python3.7/site-packages/torch/nn/modules/rnn.py:65: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.2 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
Time usage: 0:00:00
<bound method Module.parameters of Model(
  (embedding): Embedding(3553, 300, padding_idx=3552)
  (lstm): LSTM(300, 300, batch_first=True, dropout=0.2, bidirectional=True)
  (maxpool): MaxPool1d(kernel_size=20, stride=20, padding=0, dilation=1, ceil_mode=False)
  (fc): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=900, out_features=5, bias=True)
  )
)>
Epoch [1/20]
  0%|          | 0/267 [00:00<?, ?it/s]  0%|          | 1/267 [00:00<00:33,  7.95it/s]  4%|▍         | 11/267 [00:00<00:04, 55.06it/s]  8%|▊         | 21/267 [00:00<00:03, 73.62it/s] 12%|█▏        | 31/267 [00:00<00:02, 82.83it/s] 15%|█▌        | 41/267 [00:00<00:02, 88.42it/s] 19%|█▉        | 51/267 [00:00<00:02, 91.83it/s] 23%|██▎       | 61/267 [00:00<00:02, 91.31it/s] 27%|██▋       | 71/267 [00:00<00:02, 93.82it/s] 30%|███       | 81/267 [00:00<00:01, 95.35it/s] 34%|███▍      | 91/267 [00:01<00:01, 96.31it/s] 38%|███▊      | 101/267 [00:01<00:01, 96.96it/s] 42%|████▏     | 111/267 [00:01<00:01, 97.36it/s] 45%|████▌     | 121/267 [00:01<00:01, 97.69it/s] 49%|████▉     | 131/267 [00:01<00:01, 97.47it/s] 53%|█████▎    | 141/267 [00:01<00:01, 97.72it/s] 62%|██████▏   | 165/267 [00:01<00:00, 139.05it/s] 72%|███████▏  | 193/267 [00:01<00:00, 180.36it/s] 83%|████████▎ | 222/267 [00:01<00:00, 212.60it/s] 94%|█████████▍| 252/267 [00:01<00:00, 236.77it/s]100%|██████████| 267/267 [00:02<00:00, 132.22it/s]
Iter:      0,  Train Loss:   3.3,  Train Acc:  6.25%,  Val Loss:   2.5,  Val Acc: 24.61%,  Time: 0:00:00 *
Epoch [2/20]
  0%|          | 0/267 [00:00<?, ?it/s]  0%|          | 1/267 [00:00<00:29,  9.01it/s]  9%|▉         | 25/267 [00:00<00:01, 136.48it/s] 20%|██        | 54/267 [00:00<00:01, 203.91it/s] 31%|███▏      | 84/267 [00:00<00:00, 239.54it/s] 43%|████▎     | 114/267 [00:00<00:00, 259.80it/s] 54%|█████▍    | 144/267 [00:00<00:00, 271.99it/s] 65%|██████▌   | 174/267 [00:00<00:00, 278.80it/s] 76%|███████▋  | 204/267 [00:00<00:00, 283.53it/s] 87%|████████▋ | 233/267 [00:00<00:00, 283.03it/s] 99%|█████████▊| 263/267 [00:01<00:00, 286.80it/s]100%|██████████| 267/267 [00:01<00:00, 256.31it/s]
Iter:    267,  Train Loss:   1.5,  Train Acc: 34.38%,  Val Loss:   1.5,  Val Acc: 33.24%,  Time: 0:00:02 *
Epoch [3/20]
  0%|          | 0/267 [00:00<?, ?it/s]  6%|▌         | 16/267 [00:00<00:01, 159.45it/s] 17%|█▋        | 46/267 [00:00<00:00, 240.00it/s] 28%|██▊       | 76/267 [00:00<00:00, 265.30it/s] 40%|███▉      | 106/267 [00:00<00:00, 277.12it/s] 51%|█████     | 135/267 [00:00<00:00, 280.23it/s] 62%|██████▏   | 165/267 [00:00<00:00, 285.69it/s] 73%|███████▎  | 195/267 [00:00<00:00, 288.56it/s] 84%|████████▍ | 224/267 [00:00<00:00, 288.66it/s] 95%|█████████▌| 254/267 [00:00<00:00, 289.70it/s]100%|██████████| 267/267 [00:00<00:00, 279.05it/s]
Iter:    534,  Train Loss:   1.1,  Train Acc: 46.88%,  Val Loss:   1.7,  Val Acc: 34.60%,  Time: 0:00:03 
Epoch [4/20]
  0%|          | 0/267 [00:00<?, ?it/s]  6%|▋         | 17/267 [00:00<00:01, 167.55it/s] 17%|█▋        | 46/267 [00:00<00:00, 236.73it/s] 28%|██▊       | 76/267 [00:00<00:00, 263.58it/s] 40%|███▉      | 106/267 [00:00<00:00, 276.34it/s] 51%|█████     | 136/267 [00:00<00:00, 283.36it/s] 62%|██████▏   | 166/267 [00:00<00:00, 287.87it/s] 73%|███████▎  | 196/267 [00:00<00:00, 290.32it/s] 85%|████████▍ | 226/267 [00:00<00:00, 289.16it/s] 96%|█████████▌| 255/267 [00:00<00:00, 288.67it/s]100%|██████████| 267/267 [00:00<00:00, 279.15it/s]
Iter:    801,  Train Loss:   1.0,  Train Acc: 50.00%,  Val Loss:   1.9,  Val Acc: 33.88%,  Time: 0:00:04 
Epoch [5/20]
  0%|          | 0/267 [00:00<?, ?it/s]  6%|▋         | 17/267 [00:00<00:01, 167.23it/s] 17%|█▋        | 46/267 [00:00<00:00, 238.88it/s] 28%|██▊       | 76/267 [00:00<00:00, 265.12it/s] 40%|███▉      | 106/267 [00:00<00:00, 277.52it/s] 51%|█████     | 135/267 [00:00<00:00, 281.38it/s] 62%|██████▏   | 165/267 [00:00<00:00, 286.49it/s] 73%|███████▎  | 195/267 [00:00<00:00, 289.71it/s] 84%|████████▍ | 225/267 [00:00<00:00, 291.39it/s] 96%|█████████▌| 255/267 [00:00<00:00, 293.00it/s]100%|██████████| 267/267 [00:00<00:00, 280.76it/s]
Iter:   1068,  Train Loss:  0.66,  Train Acc: 62.50%,  Val Loss:   2.2,  Val Acc: 35.51%,  Time: 0:00:05 
Epoch [6/20]
  0%|          | 0/267 [00:00<?, ?it/s]  6%|▋         | 17/267 [00:00<00:01, 165.85it/s] 17%|█▋        | 46/267 [00:00<00:00, 237.44it/s] 28%|██▊       | 76/267 [00:00<00:00, 263.93it/s] 40%|███▉      | 106/267 [00:00<00:00, 276.62it/s] 51%|█████     | 136/267 [00:00<00:00, 283.59it/s] 62%|██████▏   | 166/267 [00:00<00:00, 287.80it/s] 73%|███████▎  | 196/267 [00:00<00:00, 290.52it/s] 85%|████████▍ | 226/267 [00:00<00:00, 289.68it/s] 96%|█████████▌| 256/267 [00:00<00:00, 291.65it/s]100%|██████████| 267/267 [00:00<00:00, 280.22it/s]
Iter:   1335,  Train Loss:  0.94,  Train Acc: 59.38%,  Val Loss:   2.5,  Val Acc: 34.15%,  Time: 0:00:06 
Epoch [7/20]
  0%|          | 0/267 [00:00<?, ?it/s]  6%|▋         | 17/267 [00:00<00:01, 165.65it/s] 17%|█▋        | 45/267 [00:00<00:00, 228.82it/s] 28%|██▊       | 75/267 [00:00<00:00, 258.62it/s] 39%|███▉      | 105/267 [00:00<00:00, 273.41it/s] 51%|█████     | 135/267 [00:00<00:00, 281.61it/s] 62%|██████▏   | 165/267 [00:00<00:00, 286.40it/s] 73%|███████▎  | 195/267 [00:00<00:00, 289.64it/s] 84%|████████▍ | 225/267 [00:00<00:00, 291.84it/s] 96%|█████████▌| 255/267 [00:00<00:00, 293.08it/s]100%|██████████| 267/267 [00:00<00:00, 279.45it/s]
Iter:   1602,  Train Loss:  0.35,  Train Acc: 81.25%,  Val Loss:   2.8,  Val Acc: 34.42%,  Time: 0:00:07 
Epoch [8/20]
  0%|          | 0/267 [00:00<?, ?it/s]  6%|▋         | 17/267 [00:00<00:01, 167.25it/s] 18%|█▊        | 47/267 [00:00<00:00, 242.06it/s] 27%|██▋       | 73/267 [00:00<00:00, 244.69it/s] 37%|███▋      | 98/267 [00:00<00:01, 159.23it/s] 44%|████▍     | 117/267 [00:00<00:01, 134.31it/s] 50%|████▉     | 133/267 [00:00<00:01, 122.82it/s] 55%|█████▌    | 147/267 [00:01<00:01, 115.68it/s] 60%|█████▉    | 160/267 [00:01<00:00, 111.16it/s] 64%|██████▍   | 172/267 [00:01<00:00, 107.89it/s] 69%|██████▉   | 184/267 [00:01<00:00, 105.31it/s] 73%|███████▎  | 195/267 [00:01<00:00, 103.62it/s] 77%|███████▋  | 206/267 [00:01<00:00, 102.13it/s] 81%|████████▏ | 217/267 [00:01<00:00, 101.44it/s] 85%|████████▌ | 228/267 [00:01<00:00, 100.60it/s] 90%|████████▉ | 239/267 [00:01<00:00, 99.89it/s]  94%|█████████▎| 250/267 [00:02<00:00, 99.36it/s] 97%|█████████▋| 260/267 [00:02<00:00, 99.05it/s]100%|██████████| 267/267 [00:02<00:00, 117.94it/s]
Iter:   1869,  Train Loss:   1.2,  Train Acc: 78.12%,  Val Loss:   4.1,  Val Acc: 35.97%,  Time: 0:00:08 
Epoch [9/20]
  0%|          | 0/267 [00:00<?, ?it/s]  2%|▏         | 6/267 [00:00<00:04, 56.71it/s]  6%|▋         | 17/267 [00:00<00:02, 84.65it/s] 10%|█         | 27/267 [00:00<00:02, 91.14it/s] 14%|█▍        | 37/267 [00:00<00:02, 92.29it/s] 18%|█▊        | 47/267 [00:00<00:02, 94.52it/s] 21%|██▏       | 57/267 [00:00<00:02, 96.00it/s] 25%|██▌       | 67/267 [00:00<00:02, 97.00it/s] 29%|██▉       | 77/267 [00:00<00:01, 97.66it/s] 33%|███▎      | 87/267 [00:00<00:01, 98.01it/s] 36%|███▋      | 97/267 [00:01<00:01, 98.35it/s] 40%|████      | 107/267 [00:01<00:01, 98.54it/s] 44%|████▍     | 117/267 [00:01<00:01, 98.63it/s] 48%|████▊     | 127/267 [00:01<00:01, 98.66it/s] 51%|█████▏    | 137/267 [00:01<00:01, 98.69it/s] 55%|█████▌    | 147/267 [00:01<00:01, 98.84it/s] 59%|█████▉    | 157/267 [00:01<00:01, 96.96it/s] 63%|██████▎   | 167/267 [00:01<00:01, 97.31it/s] 66%|██████▋   | 177/267 [00:01<00:00, 97.52it/s] 70%|███████   | 187/267 [00:01<00:00, 97.70it/s] 74%|███████▍  | 197/267 [00:02<00:00, 96.49it/s] 78%|███████▊  | 207/267 [00:02<00:00, 96.70it/s] 81%|████████▏ | 217/267 [00:02<00:00, 96.99it/s] 85%|████████▌ | 227/267 [00:02<00:00, 97.34it/s] 89%|████████▉ | 237/267 [00:02<00:00, 97.88it/s] 93%|█████████▎| 247/267 [00:02<00:00, 98.15it/s] 96%|█████████▋| 257/267 [00:02<00:00, 98.37it/s]100%|██████████| 267/267 [00:02<00:00, 98.54it/s]100%|██████████| 267/267 [00:02<00:00, 96.65it/s]
Iter:   2136,  Train Loss:  0.24,  Train Acc: 84.38%,  Val Loss:   4.1,  Val Acc: 36.97%,  Time: 0:00:10 
Epoch [10/20]
  0%|          | 0/267 [00:00<?, ?it/s]  2%|▏         | 6/267 [00:00<00:04, 59.07it/s]  6%|▋         | 17/267 [00:00<00:02, 84.35it/s] 10%|█         | 27/267 [00:00<00:02, 90.24it/s] 14%|█▍        | 37/267 [00:00<00:02, 92.54it/s] 18%|█▊        | 47/267 [00:00<00:02, 94.82it/s] 21%|██▏       | 57/267 [00:00<00:02, 96.29it/s] 25%|██▌       | 67/267 [00:00<00:02, 96.39it/s] 29%|██▉       | 77/267 [00:00<00:01, 95.74it/s] 33%|███▎      | 87/267 [00:00<00:01, 96.47it/s] 36%|███▋      | 97/267 [00:01<00:01, 97.07it/s] 40%|████      | 107/267 [00:01<00:01, 97.79it/s] 44%|████▍     | 117/267 [00:01<00:01, 98.27it/s] 48%|████▊     | 127/267 [00:01<00:01, 98.42it/s] 51%|█████▏    | 137/267 [00:01<00:01, 98.45it/s] 55%|█████▌    | 147/267 [00:01<00:01, 98.64it/s] 59%|█████▉    | 157/267 [00:01<00:01, 98.60it/s] 63%|██████▎   | 167/267 [00:01<00:01, 98.74it/s] 66%|██████▋   | 177/267 [00:01<00:00, 98.81it/s] 70%|███████   | 187/267 [00:01<00:00, 98.56it/s] 74%|███████▍  | 197/267 [00:02<00:00, 98.80it/s] 78%|███████▊  | 207/267 [00:02<00:00, 98.70it/s] 81%|████████▏ | 217/267 [00:02<00:00, 98.66it/s] 85%|████████▌ | 227/267 [00:02<00:00, 98.89it/s] 89%|████████▉ | 237/267 [00:02<00:00, 98.66it/s] 93%|█████████▎| 247/267 [00:02<00:00, 98.81it/s] 96%|█████████▋| 257/267 [00:02<00:00, 97.73it/s]100%|██████████| 267/267 [00:02<00:00, 96.55it/s]100%|██████████| 267/267 [00:02<00:00, 96.69it/s]
Iter:   2403,  Train Loss:  0.63,  Train Acc: 81.25%,  Val Loss:   4.2,  Val Acc: 33.42%,  Time: 0:00:13 
Epoch [11/20]
  0%|          | 0/267 [00:00<?, ?it/s]  2%|▏         | 6/267 [00:00<00:04, 59.40it/s]  6%|▋         | 17/267 [00:00<00:02, 85.16it/s] 10%|█         | 27/267 [00:00<00:02, 91.44it/s] 14%|█▍        | 37/267 [00:00<00:02, 94.39it/s] 18%|█▊        | 47/267 [00:00<00:02, 96.17it/s] 21%|██▏       | 57/267 [00:00<00:02, 95.57it/s] 25%|██▌       | 67/267 [00:00<00:02, 96.32it/s] 29%|██▉       | 77/267 [00:00<00:01, 97.12it/s] 33%|███▎      | 87/267 [00:00<00:01, 97.61it/s] 36%|███▋      | 97/267 [00:01<00:01, 96.99it/s] 40%|████      | 107/267 [00:01<00:01, 96.33it/s] 44%|████▍     | 117/267 [00:01<00:01, 96.90it/s] 48%|████▊     | 127/267 [00:01<00:01, 97.50it/s] 51%|█████▏    | 137/267 [00:01<00:01, 98.04it/s] 55%|█████▌    | 147/267 [00:01<00:01, 97.97it/s] 59%|█████▉    | 157/267 [00:01<00:01, 98.21it/s] 63%|██████▎   | 167/267 [00:01<00:01, 97.86it/s] 66%|██████▋   | 177/267 [00:01<00:00, 98.18it/s] 70%|███████   | 187/267 [00:01<00:00, 98.23it/s] 74%|███████▍  | 197/267 [00:02<00:00, 96.82it/s] 78%|███████▊  | 207/267 [00:02<00:00, 96.83it/s] 81%|████████▏ | 217/267 [00:02<00:00, 97.28it/s] 85%|████████▌ | 227/267 [00:02<00:00, 97.68it/s] 89%|████████▉ | 237/267 [00:02<00:00, 97.92it/s] 93%|█████████▎| 247/267 [00:02<00:00, 98.12it/s] 96%|█████████▋| 257/267 [00:02<00:00, 98.49it/s]100%|██████████| 267/267 [00:02<00:00, 98.21it/s]100%|██████████| 267/267 [00:02<00:00, 96.59it/s]
Iter:   2670,  Train Loss:  0.33,  Train Acc: 93.75%,  Val Loss:   3.9,  Val Acc: 34.15%,  Time: 0:00:16 
Epoch [12/20]
  0%|          | 0/267 [00:00<?, ?it/s]  2%|▏         | 6/267 [00:00<00:04, 57.91it/s]  6%|▋         | 17/267 [00:00<00:02, 85.10it/s] 10%|█         | 27/267 [00:00<00:02, 91.11it/s] 14%|█▍        | 37/267 [00:00<00:02, 93.32it/s] 18%|█▊        | 47/267 [00:00<00:02, 94.84it/s] 21%|██▏       | 57/267 [00:00<00:02, 94.42it/s] 25%|██▌       | 67/267 [00:00<00:02, 95.58it/s] 29%|██▉       | 77/267 [00:00<00:01, 96.72it/s] 33%|███▎      | 87/267 [00:00<00:01, 97.00it/s] 36%|███▋      | 97/267 [00:01<00:01, 97.55it/s] 40%|████      | 107/267 [00:01<00:01, 98.03it/s] 44%|████▍     | 117/267 [00:01<00:01, 98.39it/s] 48%|████▊     | 127/267 [00:01<00:01, 98.55it/s] 51%|█████▏    | 137/267 [00:01<00:01, 98.39it/s] 55%|█████▌    | 147/267 [00:01<00:01, 98.71it/s] 59%|█████▉    | 157/267 [00:01<00:01, 99.06it/s] 63%|██████▎   | 167/267 [00:01<00:01, 98.50it/s] 67%|██████▋   | 178/267 [00:01<00:00, 99.46it/s] 71%|███████   | 189/267 [00:01<00:00, 99.76it/s] 75%|███████▍  | 200/267 [00:02<00:00, 99.95it/s] 79%|███████▉  | 211/267 [00:02<00:00, 100.11it/s] 83%|████████▎ | 222/267 [00:02<00:00, 99.90it/s]  87%|████████▋ | 232/267 [00:02<00:00, 99.66it/s] 91%|█████████ | 242/267 [00:02<00:00, 99.53it/s] 94%|█████████▍| 252/267 [00:02<00:00, 99.08it/s] 98%|█████████▊| 262/267 [00:02<00:00, 98.93it/s]100%|██████████| 267/267 [00:02<00:00, 97.36it/s]
Iter:   2937,  Train Loss:  0.31,  Train Acc: 96.88%,  Val Loss:   4.0,  Val Acc: 33.61%,  Time: 0:00:18 
Epoch [13/20]
  0%|          | 0/267 [00:00<?, ?it/s]  0%|          | 0/267 [00:00<?, ?it/s]
Iter:   3204,  Train Loss:  0.12,  Train Acc: 96.88%,  Val Loss:   4.4,  Val Acc: 33.61%,  Time: 0:00:21 
No optimization for a long time in last 11 epochs, auto-stopping...
Test Loss:   1.5,  Test Acc: 34.03%
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

           1     0.5000    0.0358    0.0669       279
           2     0.4713    0.3760    0.4183       633
           3     0.2237    0.5913    0.3246       389
           4     0.3704    0.0588    0.1015       510
           5     0.4236    0.6115    0.5005       399

    accuracy                         0.3403      2210
   macro avg     0.3978    0.3347    0.2824      2210
weighted avg     0.3994    0.3403    0.2992      2210

Confusion Matrix...
[[ 10 103 135   3  28]
 [  5 238 322  15  53]
 [  4  77 230  15  63]
 [  0  59 233  30 188]
 [  1  28 108  18 244]]
Time usage: 0:00:00
