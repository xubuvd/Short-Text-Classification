model               : TextRCNN
embedding           : random
dataset             : MPQA
word                : True
pad                 : 10
<models.TextRCNN.Config object at 0x7f0bf7b3eb50>
Loading data...
Vocab size: 5191
0it [00:00, ?it/s]7423it [00:00, 112246.71it/s]
0it [00:00, ?it/s]1590it [00:00, 241733.48it/s]
0it [00:00, ?it/s]1590it [00:00, 200962.58it/s]
/home/pangwei/.conda/envs/vd/lib/python3.7/site-packages/torch/nn/modules/rnn.py:65: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.2 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
Time usage: 0:00:00
<bound method Module.parameters of Model(
  (embedding): Embedding(5191, 300, padding_idx=5190)
  (lstm): LSTM(300, 300, batch_first=True, dropout=0.2, bidirectional=True)
  (maxpool): MaxPool1d(kernel_size=10, stride=10, padding=0, dilation=1, ceil_mode=False)
  (fc): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=900, out_features=2, bias=True)
  )
)>
Epoch [1/20]
  0%|          | 0/115 [00:00<?, ?it/s]  1%|          | 1/115 [00:00<00:36,  3.13it/s]  7%|▋         | 8/115 [00:00<00:04, 23.75it/s] 12%|█▏        | 14/115 [00:00<00:02, 34.66it/s] 17%|█▋        | 20/115 [00:00<00:02, 42.32it/s] 23%|██▎       | 26/115 [00:00<00:01, 46.79it/s] 28%|██▊       | 32/115 [00:00<00:01, 49.37it/s] 33%|███▎      | 38/115 [00:00<00:01, 51.41it/s] 38%|███▊      | 44/115 [00:01<00:01, 51.74it/s] 44%|████▍     | 51/115 [00:01<00:01, 55.69it/s] 50%|████▉     | 57/115 [00:01<00:01, 56.34it/s] 56%|█████▌    | 64/115 [00:01<00:00, 57.14it/s] 61%|██████    | 70/115 [00:01<00:00, 57.26it/s] 68%|██████▊   | 78/115 [00:01<00:00, 62.24it/s] 75%|███████▍  | 86/115 [00:01<00:00, 65.24it/s] 81%|████████  | 93/115 [00:01<00:00, 63.50it/s] 87%|████████▋ | 100/115 [00:01<00:00, 62.49it/s] 93%|█████████▎| 107/115 [00:02<00:00, 63.01it/s]116it [00:02, 33.65it/s]                         116it [00:02, 45.48it/s]
Iter:      0,  Train Loss:  0.74,  Train Acc: 57.81%,  Val Loss:   1.4,  Val Acc: 33.40%,  Time: 0:00:00 *
Iter:    115,  Train Loss:  0.39,  Train Acc: 85.71%,  Val Loss:  0.42,  Val Acc: 82.45%,  Time: 0:00:03 *
Epoch [2/20]
  0%|          | 0/115 [00:00<?, ?it/s]  8%|▊         | 9/115 [00:00<00:01, 84.59it/s] 17%|█▋        | 19/115 [00:00<00:01, 87.38it/s] 26%|██▌       | 30/115 [00:00<00:00, 93.09it/s] 35%|███▍      | 40/115 [00:00<00:00, 87.47it/s] 43%|████▎     | 49/115 [00:00<00:00, 86.23it/s] 51%|█████▏    | 59/115 [00:00<00:00, 87.64it/s] 60%|██████    | 69/115 [00:00<00:00, 88.22it/s] 68%|██████▊   | 78/115 [00:00<00:00, 87.37it/s] 76%|███████▌  | 87/115 [00:00<00:00, 87.60it/s] 83%|████████▎ | 96/115 [00:01<00:00, 85.64it/s] 91%|█████████▏| 105/115 [00:01<00:00, 86.77it/s] 99%|█████████▉| 114/115 [00:01<00:00, 85.85it/s]116it [00:01, 70.86it/s]                         
Iter:    230,  Train Loss:  0.14,  Train Acc: 90.62%,  Val Loss:  0.47,  Val Acc: 83.27%,  Time: 0:00:04 
Epoch [3/20]
  0%|          | 0/115 [00:00<?, ?it/s]  8%|▊         | 9/115 [00:00<00:01, 88.78it/s] 16%|█▌        | 18/115 [00:00<00:01, 88.86it/s] 24%|██▍       | 28/115 [00:00<00:00, 92.49it/s] 33%|███▎      | 38/115 [00:00<00:00, 85.66it/s] 41%|████      | 47/115 [00:00<00:00, 86.00it/s] 50%|████▉     | 57/115 [00:00<00:00, 87.75it/s] 58%|█████▊    | 67/115 [00:00<00:00, 89.12it/s] 66%|██████▌   | 76/115 [00:00<00:00, 88.00it/s] 74%|███████▍  | 85/115 [00:00<00:00, 87.22it/s] 82%|████████▏ | 94/115 [00:01<00:00, 87.94it/s] 90%|████████▉ | 103/115 [00:01<00:00, 86.79it/s] 97%|█████████▋| 112/115 [00:01<00:00, 86.76it/s]116it [00:01, 71.78it/s]                         
Iter:    345,  Train Loss: 0.089,  Train Acc: 95.31%,  Val Loss:  0.54,  Val Acc: 81.89%,  Time: 0:00:06 
Epoch [4/20]
  0%|          | 0/115 [00:00<?, ?it/s]  8%|▊         | 9/115 [00:00<00:01, 84.45it/s] 16%|█▌        | 18/115 [00:00<00:01, 87.24it/s] 24%|██▍       | 28/115 [00:00<00:00, 89.38it/s] 32%|███▏      | 37/115 [00:00<00:00, 85.22it/s] 40%|████      | 46/115 [00:00<00:00, 85.99it/s] 48%|████▊     | 55/115 [00:00<00:00, 87.09it/s] 56%|█████▌    | 64/115 [00:00<00:00, 86.45it/s] 63%|██████▎   | 73/115 [00:00<00:00, 84.45it/s] 72%|███████▏  | 83/115 [00:00<00:00, 89.00it/s] 82%|████████▏ | 94/115 [00:01<00:00, 94.28it/s] 90%|█████████ | 104/115 [00:01<00:00, 93.18it/s] 99%|█████████▉| 114/115 [00:01<00:00, 58.51it/s]116it [00:01, 77.12it/s]                         
Iter:    460,  Train Loss: 0.033,  Train Acc: 100.00%,  Val Loss:  0.64,  Val Acc: 79.06%,  Time: 0:00:07 
Epoch [5/20]
  0%|          | 0/115 [00:00<?, ?it/s]  9%|▊         | 10/115 [00:00<00:01, 95.74it/s] 17%|█▋        | 20/115 [00:00<00:00, 95.88it/s] 26%|██▌       | 30/115 [00:00<00:00, 94.55it/s] 35%|███▍      | 40/115 [00:00<00:00, 90.36it/s] 43%|████▎     | 50/115 [00:00<00:00, 92.04it/s] 53%|█████▎    | 61/115 [00:00<00:00, 95.57it/s] 63%|██████▎   | 72/115 [00:00<00:00, 97.23it/s] 71%|███████▏  | 82/115 [00:00<00:00, 97.01it/s] 81%|████████  | 93/115 [00:00<00:00, 97.88it/s] 90%|████████▉ | 103/115 [00:01<00:00, 96.17it/s] 98%|█████████▊| 113/115 [00:01<00:00, 37.01it/s]116it [00:01, 65.10it/s]                         
Iter:    575,  Train Loss: 0.035,  Train Acc: 98.44%,  Val Loss:  0.75,  Val Acc: 80.44%,  Time: 0:00:09 
Epoch [6/20]
  0%|          | 0/115 [00:00<?, ?it/s]  7%|▋         | 8/115 [00:00<00:01, 68.21it/s] 13%|█▎        | 15/115 [00:00<00:01, 57.27it/s] 19%|█▉        | 22/115 [00:00<00:01, 59.58it/s] 28%|██▊       | 32/115 [00:00<00:01, 70.89it/s] 37%|███▋      | 42/115 [00:00<00:00, 80.08it/s] 44%|████▍     | 51/115 [00:00<00:00, 81.32it/s] 53%|█████▎    | 61/115 [00:00<00:00, 84.79it/s] 62%|██████▏   | 71/115 [00:00<00:00, 87.14it/s] 70%|███████   | 81/115 [00:01<00:00, 88.97it/s] 79%|███████▉  | 91/115 [00:01<00:00, 90.46it/s] 89%|████████▊ | 102/115 [00:01<00:00, 94.33it/s] 97%|█████████▋| 112/115 [00:01<00:00, 55.69it/s]116it [00:01, 71.51it/s]                         
Iter:    690,  Train Loss:  0.09,  Train Acc: 98.44%,  Val Loss:  0.72,  Val Acc: 85.09%,  Time: 0:00:11 
Epoch [7/20]
  0%|          | 0/115 [00:00<?, ?it/s]  9%|▊         | 10/115 [00:00<00:01, 93.76it/s] 17%|█▋        | 20/115 [00:00<00:01, 88.10it/s] 25%|██▌       | 29/115 [00:00<00:00, 87.03it/s] 34%|███▍      | 39/115 [00:00<00:00, 89.21it/s] 42%|████▏     | 48/115 [00:00<00:00, 85.74it/s] 50%|█████     | 58/115 [00:00<00:00, 87.62it/s] 58%|█████▊    | 67/115 [00:00<00:00, 86.47it/s] 67%|██████▋   | 77/115 [00:00<00:00, 89.29it/s] 76%|███████▌  | 87/115 [00:00<00:00, 92.22it/s] 84%|████████▍ | 97/115 [00:01<00:00, 91.05it/s] 93%|█████████▎| 107/115 [00:01<00:00, 92.28it/s]116it [00:01, 75.20it/s]                         
Iter:    805,  Train Loss: 0.055,  Train Acc: 96.88%,  Val Loss:  0.93,  Val Acc: 85.03%,  Time: 0:00:12 
Epoch [8/20]
  0%|          | 0/115 [00:00<?, ?it/s] 10%|▉         | 11/115 [00:00<00:00, 106.39it/s] 19%|█▉        | 22/115 [00:00<00:00, 96.11it/s]  29%|██▊       | 33/115 [00:00<00:00, 99.24it/s] 38%|███▊      | 44/115 [00:00<00:00, 102.51it/s] 48%|████▊     | 55/115 [00:00<00:00, 98.10it/s]  57%|█████▋    | 65/115 [00:00<00:00, 96.85it/s] 65%|██████▌   | 75/115 [00:00<00:00, 90.48it/s] 74%|███████▍  | 85/115 [00:00<00:00, 78.06it/s] 82%|████████▏ | 94/115 [00:01<00:00, 72.68it/s] 91%|█████████▏| 105/115 [00:01<00:00, 80.21it/s] 99%|█████████▉| 114/115 [00:01<00:00, 53.13it/s]116it [00:01, 75.27it/s]                         
Iter:    920,  Train Loss: 0.045,  Train Acc: 98.44%,  Val Loss:  0.79,  Val Acc: 84.03%,  Time: 0:00:14 
Epoch [9/20]
  0%|          | 0/115 [00:00<?, ?it/s] 10%|▉         | 11/115 [00:00<00:01, 100.71it/s] 19%|█▉        | 22/115 [00:00<00:00, 96.45it/s]  29%|██▊       | 33/115 [00:00<00:00, 101.66it/s] 38%|███▊      | 44/115 [00:00<00:00, 103.31it/s] 48%|████▊     | 55/115 [00:00<00:00, 98.05it/s]  58%|█████▊    | 67/115 [00:00<00:00, 103.04it/s] 68%|██████▊   | 78/115 [00:00<00:00, 103.07it/s] 77%|███████▋  | 89/115 [00:00<00:00, 96.95it/s]  86%|████████▌ | 99/115 [00:00<00:00, 97.10it/s] 95%|█████████▍| 109/115 [00:01<00:00, 68.34it/s]116it [00:01, 88.32it/s]                         
Iter:   1035,  Train Loss: 0.074,  Train Acc: 95.31%,  Val Loss:   0.8,  Val Acc: 84.21%,  Time: 0:00:15 
Epoch [10/20]
  0%|          | 0/115 [00:00<?, ?it/s] 10%|█         | 12/115 [00:00<00:00, 116.18it/s] 21%|██        | 24/115 [00:00<00:00, 108.31it/s] 30%|███       | 35/115 [00:00<00:00, 105.01it/s] 40%|████      | 46/115 [00:00<00:00, 101.69it/s] 50%|████▉     | 57/115 [00:00<00:00, 101.12it/s] 60%|██████    | 69/115 [00:00<00:00, 105.02it/s] 70%|██████▉   | 80/115 [00:00<00:00, 101.58it/s] 79%|███████▉  | 91/115 [00:00<00:00, 100.36it/s] 89%|████████▊ | 102/115 [00:01<00:00, 79.97it/s] 97%|█████████▋| 111/115 [00:01<00:00, 54.01it/s]116it [00:01, 78.19it/s]                         
Iter:   1150,  Train Loss: 0.00064,  Train Acc: 100.00%,  Val Loss:  0.81,  Val Acc: 84.97%,  Time: 0:00:16 
Epoch [11/20]
  0%|          | 0/115 [00:00<?, ?it/s]  5%|▌         | 6/115 [00:00<00:01, 59.02it/s] 11%|█▏        | 13/115 [00:00<00:01, 61.26it/s] 19%|█▉        | 22/115 [00:00<00:01, 70.80it/s] 29%|██▊       | 33/115 [00:00<00:00, 85.06it/s] 37%|███▋      | 43/115 [00:00<00:00, 89.50it/s] 45%|████▌     | 52/115 [00:00<00:00, 76.04it/s] 52%|█████▏    | 60/115 [00:00<00:00, 69.47it/s] 60%|██████    | 69/115 [00:00<00:00, 74.80it/s] 69%|██████▊   | 79/115 [00:01<00:00, 81.51it/s] 78%|███████▊  | 90/115 [00:01<00:00, 88.79it/s] 90%|████████▉ | 103/115 [00:01<00:00, 98.68it/s] 99%|█████████▉| 114/115 [00:01<00:00, 62.61it/s]116it [00:01, 73.83it/s]                         
Iter:   1265,  Train Loss: 0.014,  Train Acc: 98.44%,  Val Loss:  0.83,  Val Acc: 84.03%,  Time: 0:00:18 
Epoch [12/20]
  0%|          | 0/115 [00:00<?, ?it/s]  0%|          | 0/115 [00:00<?, ?it/s]
No optimization for a long time in last 11 epochs, auto-stopping...
Test Loss:  0.41,  Test Acc: 82.52%
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

           1     0.8328    0.9423    0.8842      1126
           2     0.7943    0.5409    0.6436       464

    accuracy                         0.8252      1590
   macro avg     0.8136    0.7416    0.7639      1590
weighted avg     0.8216    0.8252    0.8140      1590

Confusion Matrix...
[[1061   65]
 [ 213  251]]
Time usage: 0:00:00
