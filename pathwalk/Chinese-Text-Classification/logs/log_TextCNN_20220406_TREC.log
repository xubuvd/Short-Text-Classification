model               : TextCNN
embedding           : random
dataset             : TREC
word                : True
pad                 : 20
<models.TextCNN.Config object at 0x7f9738e309d0>
Loading data...
Vocab size: 8466
0it [00:00, ?it/s]5452it [00:00, 99390.40it/s]
0it [00:00, ?it/s]500it [00:00, 179920.38it/s]
0it [00:00, ?it/s]500it [00:00, 180804.55it/s]
Time usage: 0:00:00
<bound method Module.parameters of Model(
  (embedding): Embedding(8466, 300, padding_idx=8465)
  (convs): ModuleList(
    (0): Conv2d(1, 256, kernel_size=(2, 300), stride=(1, 1))
    (1): Conv2d(1, 256, kernel_size=(3, 300), stride=(1, 1))
    (2): Conv2d(1, 256, kernel_size=(4, 300), stride=(1, 1))
  )
  (fc): Sequential(
    (0): Dropout(p=0.5, inplace=False)
    (1): Linear(in_features=768, out_features=6, bias=True)
  )
)>
Epoch [1/20]
  0%|          | 0/85 [00:00<?, ?it/s]  1%|          | 1/85 [00:00<00:13,  6.16it/s]  7%|▋         | 6/85 [00:00<00:03, 23.56it/s] 12%|█▏        | 10/85 [00:00<00:02, 27.69it/s] 16%|█▋        | 14/85 [00:00<00:02, 30.23it/s] 21%|██        | 18/85 [00:00<00:02, 31.47it/s] 26%|██▌       | 22/85 [00:00<00:01, 32.41it/s] 31%|███       | 26/85 [00:00<00:01, 32.81it/s] 35%|███▌      | 30/85 [00:00<00:01, 33.25it/s] 40%|████      | 34/85 [00:01<00:01, 33.43it/s] 45%|████▍     | 38/85 [00:01<00:01, 33.64it/s] 49%|████▉     | 42/85 [00:01<00:01, 33.68it/s] 59%|█████▉    | 50/85 [00:01<00:00, 45.78it/s] 68%|██████▊   | 58/85 [00:01<00:00, 55.10it/s] 78%|███████▊  | 66/85 [00:01<00:00, 61.45it/s] 87%|████████▋ | 74/85 [00:01<00:00, 65.70it/s] 96%|█████████▋| 82/85 [00:01<00:00, 68.95it/s]86it [00:02, 42.34it/s]                        
Iter:      0,  Train Loss:   1.9,  Train Acc: 17.19%,  Val Loss:   1.5,  Val Acc: 47.20%,  Time: 0:00:00 *
Iter:     85,  Train Loss:   1.0,  Train Acc: 75.00%,  Val Loss:  0.44,  Val Acc: 84.60%,  Time: 0:00:02 *
Epoch [2/20]
  0%|          | 0/85 [00:00<?, ?it/s]  9%|▉         | 8/85 [00:00<00:00, 79.93it/s] 19%|█▉        | 16/85 [00:00<00:00, 76.85it/s] 28%|██▊       | 24/85 [00:00<00:00, 75.66it/s] 38%|███▊      | 32/85 [00:00<00:00, 75.78it/s] 47%|████▋     | 40/85 [00:00<00:00, 75.35it/s] 56%|█████▋    | 48/85 [00:00<00:00, 74.07it/s] 66%|██████▌   | 56/85 [00:00<00:00, 74.96it/s] 75%|███████▌  | 64/85 [00:00<00:00, 75.55it/s] 85%|████████▍ | 72/85 [00:00<00:00, 76.13it/s] 94%|█████████▍| 80/85 [00:01<00:00, 76.83it/s]86it [00:01, 74.98it/s]                        
Iter:    170,  Train Loss:  0.38,  Train Acc: 82.81%,  Val Loss:  0.45,  Val Acc: 81.40%,  Time: 0:00:03 
Epoch [3/20]
  0%|          | 0/85 [00:00<?, ?it/s]  9%|▉         | 8/85 [00:00<00:01, 76.33it/s] 19%|█▉        | 16/85 [00:00<00:00, 76.70it/s] 28%|██▊       | 24/85 [00:00<00:00, 76.63it/s] 38%|███▊      | 32/85 [00:00<00:00, 76.89it/s] 47%|████▋     | 40/85 [00:00<00:00, 77.14it/s] 56%|█████▋    | 48/85 [00:00<00:00, 76.24it/s] 66%|██████▌   | 56/85 [00:00<00:00, 76.55it/s] 75%|███████▌  | 64/85 [00:00<00:00, 76.61it/s] 85%|████████▍ | 72/85 [00:00<00:00, 76.74it/s] 94%|█████████▍| 80/85 [00:01<00:00, 76.83it/s]86it [00:01, 73.30it/s]                        
Iter:    255,  Train Loss:  0.39,  Train Acc: 85.94%,  Val Loss:  0.43,  Val Acc: 83.60%,  Time: 0:00:04 *
Epoch [4/20]
  0%|          | 0/85 [00:00<?, ?it/s]  9%|▉         | 8/85 [00:00<00:00, 77.61it/s] 19%|█▉        | 16/85 [00:00<00:00, 77.12it/s] 28%|██▊       | 24/85 [00:00<00:00, 76.98it/s] 38%|███▊      | 32/85 [00:00<00:00, 76.96it/s] 47%|████▋     | 40/85 [00:00<00:00, 76.98it/s] 56%|█████▋    | 48/85 [00:00<00:00, 77.09it/s] 66%|██████▌   | 56/85 [00:00<00:00, 76.76it/s] 75%|███████▌  | 64/85 [00:00<00:00, 76.72it/s] 85%|████████▍ | 72/85 [00:00<00:00, 76.30it/s] 94%|█████████▍| 80/85 [00:01<00:00, 76.42it/s]86it [00:01, 75.88it/s]                        
Iter:    340,  Train Loss:  0.17,  Train Acc: 95.31%,  Val Loss:  0.44,  Val Acc: 84.40%,  Time: 0:00:05 
Epoch [5/20]
  0%|          | 0/85 [00:00<?, ?it/s]  9%|▉         | 8/85 [00:00<00:00, 77.65it/s] 19%|█▉        | 16/85 [00:00<00:00, 76.79it/s] 28%|██▊       | 24/85 [00:00<00:00, 76.81it/s] 38%|███▊      | 32/85 [00:00<00:00, 76.51it/s] 47%|████▋     | 40/85 [00:00<00:00, 76.52it/s] 56%|█████▋    | 48/85 [00:00<00:00, 76.59it/s] 66%|██████▌   | 56/85 [00:00<00:00, 76.91it/s] 75%|███████▌  | 64/85 [00:00<00:00, 77.27it/s] 85%|████████▍ | 72/85 [00:00<00:00, 77.21it/s] 94%|█████████▍| 80/85 [00:01<00:00, 76.14it/s]86it [00:01, 74.89it/s]                        
Iter:    425,  Train Loss: 0.081,  Train Acc: 98.44%,  Val Loss:  0.49,  Val Acc: 83.80%,  Time: 0:00:07 
Epoch [6/20]
  0%|          | 0/85 [00:00<?, ?it/s]  7%|▋         | 6/85 [00:00<00:01, 56.51it/s] 14%|█▍        | 12/85 [00:00<00:01, 55.61it/s] 21%|██        | 18/85 [00:00<00:01, 54.98it/s] 28%|██▊       | 24/85 [00:00<00:01, 53.63it/s] 35%|███▌      | 30/85 [00:00<00:01, 54.09it/s] 42%|████▏     | 36/85 [00:00<00:00, 54.38it/s] 49%|████▉     | 42/85 [00:00<00:00, 53.36it/s] 56%|█████▋    | 48/85 [00:00<00:00, 53.59it/s] 64%|██████▎   | 54/85 [00:01<00:00, 52.44it/s] 71%|███████   | 60/85 [00:01<00:00, 52.93it/s] 78%|███████▊  | 66/85 [00:01<00:00, 53.87it/s] 85%|████████▍ | 72/85 [00:01<00:00, 52.68it/s] 92%|█████████▏| 78/85 [00:01<00:00, 51.52it/s] 99%|█████████▉| 84/85 [00:01<00:00, 41.49it/s]86it [00:01, 50.35it/s]                        
Iter:    510,  Train Loss: 0.071,  Train Acc: 98.44%,  Val Loss:  0.41,  Val Acc: 87.40%,  Time: 0:00:08 *
Epoch [7/20]
  0%|          | 0/85 [00:00<?, ?it/s]  7%|▋         | 6/85 [00:00<00:01, 52.13it/s] 14%|█▍        | 12/85 [00:00<00:01, 52.18it/s] 21%|██        | 18/85 [00:00<00:01, 52.26it/s] 28%|██▊       | 24/85 [00:00<00:01, 52.97it/s] 35%|███▌      | 30/85 [00:00<00:01, 54.15it/s] 42%|████▏     | 36/85 [00:00<00:00, 53.28it/s] 49%|████▉     | 42/85 [00:00<00:00, 53.65it/s] 56%|█████▋    | 48/85 [00:00<00:00, 54.37it/s] 64%|██████▎   | 54/85 [00:01<00:00, 52.21it/s] 71%|███████   | 60/85 [00:01<00:00, 53.30it/s] 78%|███████▊  | 66/85 [00:01<00:00, 53.19it/s] 85%|████████▍ | 72/85 [00:01<00:00, 53.46it/s] 92%|█████████▏| 78/85 [00:01<00:00, 53.56it/s] 99%|█████████▉| 84/85 [00:01<00:00, 48.65it/s]86it [00:01, 52.00it/s]                        
Iter:    595,  Train Loss: 0.019,  Train Acc: 100.00%,  Val Loss:  0.45,  Val Acc: 87.80%,  Time: 0:00:10 
Epoch [8/20]
  0%|          | 0/85 [00:00<?, ?it/s]  7%|▋         | 6/85 [00:00<00:01, 55.96it/s] 14%|█▍        | 12/85 [00:00<00:01, 55.90it/s] 21%|██        | 18/85 [00:00<00:01, 55.68it/s] 28%|██▊       | 24/85 [00:00<00:01, 55.26it/s] 35%|███▌      | 30/85 [00:00<00:00, 55.24it/s] 42%|████▏     | 36/85 [00:00<00:00, 53.81it/s] 49%|████▉     | 42/85 [00:00<00:00, 53.82it/s] 56%|█████▋    | 48/85 [00:00<00:00, 54.61it/s] 64%|██████▎   | 54/85 [00:00<00:00, 54.92it/s] 71%|███████   | 60/85 [00:01<00:00, 53.48it/s] 78%|███████▊  | 66/85 [00:01<00:00, 53.70it/s] 85%|████████▍ | 72/85 [00:01<00:00, 54.34it/s] 92%|█████████▏| 78/85 [00:01<00:00, 53.42it/s] 99%|█████████▉| 84/85 [00:01<00:00, 49.72it/s]86it [00:01, 53.28it/s]                        
Iter:    680,  Train Loss: 0.021,  Train Acc: 100.00%,  Val Loss:  0.44,  Val Acc: 87.00%,  Time: 0:00:11 
Epoch [9/20]
  0%|          | 0/85 [00:00<?, ?it/s]  7%|▋         | 6/85 [00:00<00:01, 52.21it/s] 14%|█▍        | 12/85 [00:00<00:01, 52.35it/s] 21%|██        | 18/85 [00:00<00:01, 53.14it/s] 28%|██▊       | 24/85 [00:00<00:01, 54.11it/s] 35%|███▌      | 30/85 [00:00<00:01, 53.12it/s] 42%|████▏     | 36/85 [00:00<00:00, 52.31it/s] 49%|████▉     | 42/85 [00:00<00:00, 52.40it/s] 56%|█████▋    | 48/85 [00:00<00:00, 53.52it/s] 64%|██████▎   | 54/85 [00:01<00:00, 52.86it/s] 71%|███████   | 60/85 [00:01<00:00, 52.59it/s] 78%|███████▊  | 66/85 [00:01<00:00, 52.44it/s] 85%|████████▍ | 72/85 [00:01<00:00, 53.43it/s] 92%|█████████▏| 78/85 [00:01<00:00, 49.39it/s]100%|██████████| 85/85 [00:01<00:00, 52.97it/s]86it [00:01, 52.48it/s]                        
Iter:    765,  Train Loss: 0.017,  Train Acc: 100.00%,  Val Loss:  0.46,  Val Acc: 87.80%,  Time: 0:00:13 
Epoch [10/20]
  0%|          | 0/85 [00:00<?, ?it/s]  7%|▋         | 6/85 [00:00<00:01, 55.93it/s] 14%|█▍        | 12/85 [00:00<00:01, 54.74it/s] 21%|██        | 18/85 [00:00<00:01, 55.40it/s] 28%|██▊       | 24/85 [00:00<00:01, 53.76it/s] 35%|███▌      | 30/85 [00:00<00:01, 54.08it/s] 42%|████▏     | 36/85 [00:00<00:00, 54.58it/s] 49%|████▉     | 42/85 [00:00<00:00, 53.09it/s] 56%|█████▋    | 48/85 [00:00<00:00, 53.45it/s] 64%|██████▎   | 54/85 [00:00<00:00, 54.41it/s] 71%|███████   | 60/85 [00:01<00:00, 54.40it/s] 78%|███████▊  | 66/85 [00:01<00:00, 52.57it/s] 85%|████████▍ | 72/85 [00:01<00:00, 52.47it/s] 92%|█████████▏| 78/85 [00:01<00:00, 51.12it/s] 99%|█████████▉| 84/85 [00:01<00:00, 51.08it/s]86it [00:01, 52.84it/s]                        
Iter:    850,  Train Loss: 0.019,  Train Acc: 100.00%,  Val Loss:  0.41,  Val Acc: 88.20%,  Time: 0:00:15 
Epoch [11/20]
  0%|          | 0/85 [00:00<?, ?it/s]  7%|▋         | 6/85 [00:00<00:01, 54.90it/s] 14%|█▍        | 12/85 [00:00<00:01, 55.10it/s] 21%|██        | 18/85 [00:00<00:01, 53.24it/s] 28%|██▊       | 24/85 [00:00<00:01, 53.72it/s] 35%|███▌      | 30/85 [00:00<00:01, 52.72it/s] 42%|████▏     | 36/85 [00:00<00:00, 53.60it/s] 49%|████▉     | 42/85 [00:00<00:00, 53.80it/s] 56%|█████▋    | 48/85 [00:00<00:00, 52.98it/s] 64%|██████▎   | 54/85 [00:01<00:00, 51.53it/s] 71%|███████   | 60/85 [00:01<00:00, 52.33it/s] 78%|███████▊  | 66/85 [00:01<00:00, 53.25it/s] 85%|████████▍ | 72/85 [00:01<00:00, 52.82it/s] 92%|█████████▏| 78/85 [00:01<00:00, 49.87it/s] 99%|█████████▉| 84/85 [00:01<00:00, 51.17it/s]86it [00:01, 52.48it/s]                        
Iter:    935,  Train Loss: 0.0053,  Train Acc: 100.00%,  Val Loss:  0.49,  Val Acc: 87.20%,  Time: 0:00:16 
Epoch [12/20]
  0%|          | 0/85 [00:00<?, ?it/s]  7%|▋         | 6/85 [00:00<00:01, 54.20it/s] 14%|█▍        | 12/85 [00:00<00:01, 54.29it/s] 21%|██        | 18/85 [00:00<00:01, 53.33it/s] 28%|██▊       | 24/85 [00:00<00:01, 53.67it/s] 35%|███▌      | 30/85 [00:00<00:01, 52.37it/s] 42%|████▏     | 36/85 [00:00<00:00, 52.29it/s] 49%|████▉     | 42/85 [00:00<00:00, 52.26it/s] 56%|█████▋    | 48/85 [00:00<00:00, 52.92it/s] 66%|██████▌   | 56/85 [00:01<00:00, 59.76it/s] 75%|███████▌  | 64/85 [00:01<00:00, 65.21it/s] 85%|████████▍ | 72/85 [00:01<00:00, 69.02it/s] 93%|█████████▎| 79/85 [00:01<00:00, 64.97it/s]86it [00:01, 61.07it/s]                        86it [00:01, 58.49it/s]
Iter:   1020,  Train Loss: 0.011,  Train Acc: 100.00%,  Val Loss:  0.45,  Val Acc: 87.80%,  Time: 0:00:18 
Epoch [13/20]
  0%|          | 0/85 [00:00<?, ?it/s]  7%|▋         | 6/85 [00:00<00:01, 51.54it/s] 14%|█▍        | 12/85 [00:00<00:01, 51.64it/s] 21%|██        | 18/85 [00:00<00:01, 51.35it/s] 28%|██▊       | 24/85 [00:00<00:01, 49.66it/s] 36%|███▋      | 31/85 [00:00<00:00, 55.83it/s] 46%|████▌     | 39/85 [00:00<00:00, 62.53it/s] 55%|█████▌    | 47/85 [00:00<00:00, 67.41it/s] 65%|██████▍   | 55/85 [00:00<00:00, 70.62it/s] 74%|███████▍  | 63/85 [00:00<00:00, 72.49it/s] 84%|████████▎ | 71/85 [00:01<00:00, 74.25it/s] 93%|█████████▎| 79/85 [00:01<00:00, 62.62it/s]86it [00:01, 60.74it/s]                        86it [00:01, 61.85it/s]
Iter:   1105,  Train Loss: 0.024,  Train Acc: 98.44%,  Val Loss:  0.48,  Val Acc: 87.00%,  Time: 0:00:19 
Epoch [14/20]
  0%|          | 0/85 [00:00<?, ?it/s]  7%|▋         | 6/85 [00:00<00:01, 56.68it/s] 14%|█▍        | 12/85 [00:00<00:01, 55.98it/s] 21%|██        | 18/85 [00:00<00:01, 53.64it/s] 28%|██▊       | 24/85 [00:00<00:01, 52.93it/s] 35%|███▌      | 30/85 [00:00<00:01, 52.56it/s] 42%|████▏     | 36/85 [00:00<00:00, 53.18it/s] 49%|████▉     | 42/85 [00:00<00:00, 51.35it/s] 56%|█████▋    | 48/85 [00:00<00:00, 51.62it/s] 64%|██████▎   | 54/85 [00:01<00:00, 52.74it/s] 71%|███████   | 60/85 [00:01<00:00, 53.93it/s] 78%|███████▊  | 66/85 [00:01<00:00, 54.89it/s] 85%|████████▍ | 72/85 [00:01<00:00, 53.33it/s] 92%|█████████▏| 78/85 [00:01<00:00, 50.30it/s] 99%|█████████▉| 84/85 [00:01<00:00, 51.54it/s]86it [00:01, 52.43it/s]                        
Iter:   1190,  Train Loss: 0.0058,  Train Acc: 100.00%,  Val Loss:  0.47,  Val Acc: 87.00%,  Time: 0:00:21 
Epoch [15/20]
  0%|          | 0/85 [00:00<?, ?it/s]  7%|▋         | 6/85 [00:00<00:01, 53.18it/s] 14%|█▍        | 12/85 [00:00<00:01, 55.37it/s] 21%|██        | 18/85 [00:00<00:01, 55.33it/s] 28%|██▊       | 24/85 [00:00<00:01, 55.60it/s] 35%|███▌      | 30/85 [00:00<00:00, 55.87it/s] 42%|████▏     | 36/85 [00:00<00:00, 55.82it/s] 49%|████▉     | 42/85 [00:00<00:00, 53.59it/s] 56%|█████▋    | 48/85 [00:00<00:00, 52.49it/s] 64%|██████▎   | 54/85 [00:00<00:00, 53.67it/s] 71%|███████   | 60/85 [00:01<00:00, 54.28it/s] 78%|███████▊  | 66/85 [00:01<00:00, 54.99it/s] 85%|████████▍ | 72/85 [00:01<00:00, 47.88it/s] 93%|█████████▎| 79/85 [00:01<00:00, 52.04it/s]100%|██████████| 85/85 [00:01<00:00, 51.97it/s]86it [00:01, 53.18it/s]                        
Iter:   1275,  Train Loss: 0.0055,  Train Acc: 100.00%,  Val Loss:  0.47,  Val Acc: 87.80%,  Time: 0:00:22 
Epoch [16/20]
  0%|          | 0/85 [00:00<?, ?it/s]  7%|▋         | 6/85 [00:00<00:01, 51.47it/s] 14%|█▍        | 12/85 [00:00<00:01, 52.30it/s] 21%|██        | 18/85 [00:00<00:01, 53.92it/s] 28%|██▊       | 24/85 [00:00<00:01, 51.62it/s] 35%|███▌      | 30/85 [00:00<00:01, 51.68it/s] 42%|████▏     | 36/85 [00:00<00:00, 52.56it/s] 49%|████▉     | 42/85 [00:00<00:00, 52.36it/s] 56%|█████▋    | 48/85 [00:00<00:00, 51.99it/s] 64%|██████▎   | 54/85 [00:01<00:00, 51.93it/s] 71%|███████   | 60/85 [00:01<00:00, 53.10it/s] 78%|███████▊  | 66/85 [00:01<00:00, 53.62it/s] 85%|████████▍ | 72/85 [00:01<00:00, 49.46it/s] 92%|█████████▏| 78/85 [00:01<00:00, 50.52it/s] 99%|█████████▉| 84/85 [00:01<00:00, 51.79it/s]86it [00:01, 51.81it/s]                        
Iter:   1360,  Train Loss: 0.021,  Train Acc: 98.44%,  Val Loss:  0.45,  Val Acc: 87.60%,  Time: 0:00:24 
Epoch [17/20]
  0%|          | 0/85 [00:00<?, ?it/s]  0%|          | 0/85 [00:00<?, ?it/s]
No optimization for a long time in last 11 epochs, auto-stopping...
Test Loss:  0.41,  Test Acc: 87.40%
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

           1     0.8882    0.9783    0.9310       138
           2     0.8171    0.7128    0.7614        94
           3     1.0000    0.7778    0.8750         9
           4     0.8082    0.9077    0.8551        65
           5     0.8202    0.9012    0.8588        81
           6     0.9897    0.8496    0.9143       113

    accuracy                         0.8740       500
   macro avg     0.8872    0.8545    0.8659       500
weighted avg     0.8784    0.8740    0.8728       500

Confusion Matrix...
[[135   2   0   1   0   0]
 [ 10  67   0  10   6   1]
 [  2   0   7   0   0   0]
 [  0   3   0  59   3   0]
 [  3   3   0   2  73   0]
 [  2   7   0   1   7  96]]
Time usage: 0:00:00
