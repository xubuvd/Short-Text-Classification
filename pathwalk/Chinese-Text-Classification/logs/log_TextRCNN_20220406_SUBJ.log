model               : TextRCNN
embedding           : random
dataset             : SUBJ
word                : True
pad                 : 25
<models.TextRCNN.Config object at 0x7f18d3fdba50>
Loading data...
Vocab size: 10002
0it [00:00, ?it/s]6827it [00:00, 68260.30it/s]7001it [00:00, 68747.33it/s]
0it [00:00, ?it/s]1495it [00:00, 94716.02it/s]
0it [00:00, ?it/s]1499it [00:00, 94216.59it/s]
/home/pangwei/.conda/envs/vd/lib/python3.7/site-packages/torch/nn/modules/rnn.py:65: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.2 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
Time usage: 0:00:00
<bound method Module.parameters of Model(
  (embedding): Embedding(10002, 300, padding_idx=10001)
  (lstm): LSTM(300, 300, batch_first=True, dropout=0.2, bidirectional=True)
  (maxpool): MaxPool1d(kernel_size=25, stride=25, padding=0, dilation=1, ceil_mode=False)
  (fc): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=900, out_features=2, bias=True)
  )
)>
Epoch [1/20]
  0%|          | 0/109 [00:00<?, ?it/s]  1%|          | 1/109 [00:00<00:54,  1.99it/s]  6%|▋         | 7/109 [00:00<00:06, 14.67it/s] 12%|█▏        | 13/109 [00:00<00:03, 25.15it/s] 17%|█▋        | 19/109 [00:00<00:02, 33.27it/s] 24%|██▍       | 26/109 [00:00<00:02, 40.95it/s] 30%|███       | 33/109 [00:01<00:01, 47.86it/s] 36%|███▌      | 39/109 [00:01<00:01, 48.80it/s] 41%|████▏     | 45/109 [00:01<00:01, 51.58it/s] 48%|████▊     | 52/109 [00:01<00:01, 54.13it/s] 54%|█████▍    | 59/109 [00:01<00:00, 56.16it/s] 60%|█████▉    | 65/109 [00:01<00:00, 56.71it/s] 65%|██████▌   | 71/109 [00:01<00:00, 54.93it/s] 72%|███████▏  | 78/109 [00:01<00:00, 56.97it/s] 77%|███████▋  | 84/109 [00:01<00:00, 56.24it/s] 83%|████████▎ | 90/109 [00:02<00:00, 56.25it/s] 88%|████████▊ | 96/109 [00:02<00:00, 56.15it/s] 94%|█████████▎| 102/109 [00:02<00:00, 55.36it/s] 99%|█████████▉| 108/109 [00:02<00:00, 56.49it/s]110it [00:02, 38.10it/s]                         
Iter:      0,  Train Loss:   1.7,  Train Acc: 48.44%,  Val Loss:   3.4,  Val Acc: 48.85%,  Time: 0:00:01 *
Iter:    109,  Train Loss:  0.39,  Train Acc: 88.00%,  Val Loss:  0.29,  Val Acc: 87.98%,  Time: 0:00:03 *
Epoch [2/20]
  0%|          | 0/109 [00:00<?, ?it/s]  6%|▌         | 6/109 [00:00<00:01, 59.74it/s] 12%|█▏        | 13/109 [00:00<00:01, 61.63it/s] 18%|█▊        | 20/109 [00:00<00:01, 57.38it/s] 25%|██▍       | 27/109 [00:00<00:01, 59.26it/s] 31%|███       | 34/109 [00:00<00:01, 60.64it/s] 38%|███▊      | 41/109 [00:00<00:01, 61.07it/s] 44%|████▍     | 48/109 [00:00<00:01, 59.78it/s] 50%|████▉     | 54/109 [00:00<00:00, 58.81it/s] 55%|█████▌    | 60/109 [00:01<00:00, 59.01it/s] 61%|██████    | 66/109 [00:01<00:00, 59.18it/s] 67%|██████▋   | 73/109 [00:01<00:00, 59.15it/s] 72%|███████▏  | 79/109 [00:01<00:00, 59.17it/s] 78%|███████▊  | 85/109 [00:01<00:00, 59.03it/s] 83%|████████▎ | 91/109 [00:01<00:00, 59.15it/s] 90%|████████▉ | 98/109 [00:01<00:00, 59.74it/s] 96%|█████████▋| 105/109 [00:01<00:00, 60.35it/s]110it [00:02, 50.05it/s]                         
Iter:    218,  Train Loss: 0.063,  Train Acc: 96.88%,  Val Loss:  0.34,  Val Acc: 88.04%,  Time: 0:00:05 
Epoch [3/20]
  0%|          | 0/109 [00:00<?, ?it/s]  6%|▌         | 6/109 [00:00<00:02, 51.27it/s] 12%|█▏        | 13/109 [00:00<00:01, 59.87it/s] 18%|█▊        | 20/109 [00:00<00:01, 60.31it/s] 25%|██▍       | 27/109 [00:00<00:01, 61.15it/s] 31%|███       | 34/109 [00:00<00:01, 58.71it/s] 37%|███▋      | 40/109 [00:00<00:01, 56.97it/s] 43%|████▎     | 47/109 [00:00<00:01, 59.02it/s] 49%|████▊     | 53/109 [00:00<00:00, 58.53it/s] 54%|█████▍    | 59/109 [00:01<00:00, 58.77it/s] 61%|██████    | 66/109 [00:01<00:00, 59.12it/s] 66%|██████▌   | 72/109 [00:01<00:00, 57.70it/s] 72%|███████▏  | 79/109 [00:01<00:00, 59.89it/s] 79%|███████▉  | 86/109 [00:01<00:00, 60.54it/s] 85%|████████▌ | 93/109 [00:01<00:00, 61.03it/s] 92%|█████████▏| 100/109 [00:01<00:00, 59.04it/s] 97%|█████████▋| 106/109 [00:01<00:00, 58.31it/s]110it [00:02, 49.72it/s]                         
Iter:    327,  Train Loss: 0.0034,  Train Acc: 100.00%,  Val Loss:  0.48,  Val Acc: 87.50%,  Time: 0:00:07 
Epoch [4/20]
  0%|          | 0/109 [00:00<?, ?it/s]  6%|▌         | 6/109 [00:00<00:01, 54.35it/s] 12%|█▏        | 13/109 [00:00<00:01, 61.30it/s] 18%|█▊        | 20/109 [00:00<00:01, 62.53it/s] 25%|██▍       | 27/109 [00:00<00:01, 59.13it/s] 30%|███       | 33/109 [00:00<00:01, 58.27it/s] 37%|███▋      | 40/109 [00:00<00:01, 59.59it/s] 43%|████▎     | 47/109 [00:00<00:01, 60.76it/s] 50%|████▉     | 54/109 [00:00<00:00, 61.69it/s] 56%|█████▌    | 61/109 [00:01<00:00, 58.94it/s] 61%|██████▏   | 67/109 [00:01<00:00, 58.75it/s] 68%|██████▊   | 74/109 [00:01<00:00, 59.63it/s] 74%|███████▍  | 81/109 [00:01<00:00, 59.12it/s] 80%|███████▉  | 87/109 [00:01<00:00, 58.52it/s] 85%|████████▌ | 93/109 [00:01<00:00, 58.07it/s] 92%|█████████▏| 100/109 [00:01<00:00, 59.54it/s] 97%|█████████▋| 106/109 [00:01<00:00, 59.33it/s]110it [00:02, 49.66it/s]                         
Iter:    436,  Train Loss:  0.01,  Train Acc: 100.00%,  Val Loss:  0.49,  Val Acc: 87.43%,  Time: 0:00:09 
Epoch [5/20]
  0%|          | 0/109 [00:00<?, ?it/s]  6%|▋         | 7/109 [00:00<00:01, 63.50it/s] 13%|█▎        | 14/109 [00:00<00:01, 58.96it/s] 18%|█▊        | 20/109 [00:00<00:01, 57.94it/s] 24%|██▍       | 26/109 [00:00<00:01, 58.32it/s] 30%|███       | 33/109 [00:00<00:01, 59.42it/s] 37%|███▋      | 40/109 [00:00<00:01, 60.76it/s] 43%|████▎     | 47/109 [00:00<00:01, 57.44it/s] 49%|████▊     | 53/109 [00:00<00:00, 57.27it/s] 54%|█████▍    | 59/109 [00:01<00:00, 57.48it/s] 60%|█████▉    | 65/109 [00:01<00:00, 57.10it/s] 65%|██████▌   | 71/109 [00:01<00:00, 56.80it/s] 71%|███████   | 77/109 [00:01<00:00, 54.91it/s] 77%|███████▋  | 84/109 [00:01<00:00, 56.83it/s] 83%|████████▎ | 91/109 [00:01<00:00, 58.84it/s] 90%|████████▉ | 98/109 [00:01<00:00, 59.95it/s] 96%|█████████▋| 105/109 [00:01<00:00, 59.76it/s]110it [00:02, 50.29it/s]                         
Iter:    545,  Train Loss: 0.0015,  Train Acc: 100.00%,  Val Loss:  0.56,  Val Acc: 87.70%,  Time: 0:00:12 
Epoch [6/20]
  0%|          | 0/109 [00:00<?, ?it/s]  6%|▌         | 6/109 [00:00<00:01, 56.04it/s] 11%|█         | 12/109 [00:00<00:01, 57.20it/s] 17%|█▋        | 18/109 [00:00<00:01, 56.68it/s] 23%|██▎       | 25/109 [00:00<00:01, 58.21it/s] 29%|██▉       | 32/109 [00:00<00:01, 59.67it/s] 35%|███▍      | 38/109 [00:00<00:01, 57.32it/s] 40%|████      | 44/109 [00:00<00:01, 55.92it/s] 47%|████▋     | 51/109 [00:00<00:01, 57.41it/s] 53%|█████▎    | 58/109 [00:00<00:00, 59.87it/s] 60%|█████▉    | 65/109 [00:01<00:00, 60.35it/s] 66%|██████▌   | 72/109 [00:01<00:00, 58.48it/s] 72%|███████▏  | 79/109 [00:01<00:00, 59.24it/s] 78%|███████▊  | 85/109 [00:01<00:00, 58.33it/s] 84%|████████▍ | 92/109 [00:01<00:00, 59.91it/s] 90%|████████▉ | 98/109 [00:01<00:00, 57.53it/s] 95%|█████████▌| 104/109 [00:01<00:00, 57.16it/s]110it [00:02, 28.42it/s]                         110it [00:02, 48.60it/s]
Iter:    654,  Train Loss: 0.00093,  Train Acc: 100.00%,  Val Loss:  0.56,  Val Acc: 87.43%,  Time: 0:00:14 
Epoch [7/20]
  0%|          | 0/109 [00:00<?, ?it/s]  6%|▋         | 7/109 [00:00<00:01, 64.33it/s] 13%|█▎        | 14/109 [00:00<00:01, 61.18it/s] 19%|█▉        | 21/109 [00:00<00:01, 61.55it/s] 26%|██▌       | 28/109 [00:00<00:01, 60.81it/s] 32%|███▏      | 35/109 [00:00<00:01, 59.26it/s] 38%|███▊      | 41/109 [00:00<00:01, 57.75it/s] 44%|████▍     | 48/109 [00:00<00:01, 59.18it/s] 50%|████▉     | 54/109 [00:00<00:00, 57.66it/s] 55%|█████▌    | 60/109 [00:01<00:00, 58.14it/s] 61%|██████    | 66/109 [00:01<00:00, 56.95it/s] 66%|██████▌   | 72/109 [00:01<00:00, 56.69it/s] 72%|███████▏  | 79/109 [00:01<00:00, 57.52it/s] 78%|███████▊  | 85/109 [00:01<00:00, 56.35it/s] 83%|████████▎ | 91/109 [00:01<00:00, 57.23it/s] 89%|████████▉ | 97/109 [00:01<00:00, 57.05it/s] 95%|█████████▌| 104/109 [00:02<00:00, 28.29it/s]110it [00:02, 48.58it/s]                         
Iter:    763,  Train Loss: 8.4e-05,  Train Acc: 100.00%,  Val Loss:  0.57,  Val Acc: 87.84%,  Time: 0:00:16 
Epoch [8/20]
  0%|          | 0/109 [00:00<?, ?it/s]  6%|▌         | 6/109 [00:00<00:01, 55.04it/s] 11%|█         | 12/109 [00:00<00:01, 57.03it/s] 17%|█▋        | 19/109 [00:00<00:01, 58.57it/s] 23%|██▎       | 25/109 [00:00<00:01, 58.20it/s] 28%|██▊       | 31/109 [00:00<00:01, 58.44it/s] 34%|███▍      | 37/109 [00:00<00:01, 58.70it/s] 39%|███▉      | 43/109 [00:00<00:01, 56.89it/s] 46%|████▌     | 50/109 [00:00<00:00, 59.62it/s] 51%|█████▏    | 56/109 [00:00<00:00, 59.68it/s] 58%|█████▊    | 63/109 [00:01<00:00, 60.18it/s] 64%|██████▍   | 70/109 [00:01<00:00, 57.13it/s] 70%|██████▉   | 76/109 [00:01<00:00, 56.28it/s] 75%|███████▌  | 82/109 [00:01<00:00, 57.03it/s] 81%|████████  | 88/109 [00:01<00:00, 56.27it/s] 86%|████████▌ | 94/109 [00:01<00:00, 56.26it/s] 92%|█████████▏| 100/109 [00:01<00:00, 55.63it/s] 97%|█████████▋| 106/109 [00:02<00:00, 27.69it/s]110it [00:02, 48.06it/s]                         
Iter:    872,  Train Loss: 6.3e-05,  Train Acc: 100.00%,  Val Loss:  0.58,  Val Acc: 87.91%,  Time: 0:00:18 
Epoch [9/20]
  0%|          | 0/109 [00:00<?, ?it/s]  6%|▋         | 7/109 [00:00<00:01, 62.89it/s] 13%|█▎        | 14/109 [00:00<00:01, 66.22it/s] 19%|█▉        | 21/109 [00:00<00:01, 61.54it/s] 26%|██▌       | 28/109 [00:00<00:01, 58.17it/s] 32%|███▏      | 35/109 [00:00<00:01, 59.81it/s] 39%|███▊      | 42/109 [00:00<00:01, 59.53it/s] 45%|████▍     | 49/109 [00:00<00:00, 61.09it/s] 51%|█████▏    | 56/109 [00:00<00:00, 58.80it/s] 57%|█████▋    | 62/109 [00:01<00:00, 58.36it/s] 62%|██████▏   | 68/109 [00:01<00:00, 58.80it/s] 69%|██████▉   | 75/109 [00:01<00:00, 59.72it/s] 74%|███████▍  | 81/109 [00:01<00:00, 58.88it/s] 80%|███████▉  | 87/109 [00:01<00:00, 57.81it/s] 85%|████████▌ | 93/109 [00:01<00:00, 57.54it/s] 92%|█████████▏| 100/109 [00:01<00:00, 58.32it/s] 97%|█████████▋| 106/109 [00:02<00:00, 29.70it/s]110it [00:02, 50.09it/s]                         
Iter:    981,  Train Loss: 8.3e-05,  Train Acc: 100.00%,  Val Loss:  0.59,  Val Acc: 87.84%,  Time: 0:00:21 
Epoch [10/20]
  0%|          | 0/109 [00:00<?, ?it/s]  6%|▋         | 7/109 [00:00<00:01, 61.25it/s] 13%|█▎        | 14/109 [00:00<00:01, 57.00it/s] 18%|█▊        | 20/109 [00:00<00:01, 57.83it/s] 25%|██▍       | 27/109 [00:00<00:01, 60.99it/s] 31%|███       | 34/109 [00:00<00:01, 59.77it/s] 37%|███▋      | 40/109 [00:00<00:01, 58.14it/s] 42%|████▏     | 46/109 [00:00<00:01, 56.07it/s] 48%|████▊     | 52/109 [00:00<00:01, 56.83it/s] 54%|█████▍    | 59/109 [00:01<00:00, 59.25it/s] 61%|██████    | 66/109 [00:01<00:00, 61.63it/s] 67%|██████▋   | 73/109 [00:01<00:00, 59.57it/s] 72%|███████▏  | 79/109 [00:01<00:00, 58.32it/s] 78%|███████▊  | 85/109 [00:01<00:00, 58.65it/s] 84%|████████▍ | 92/109 [00:01<00:00, 59.56it/s] 92%|█████████▏| 100/109 [00:01<00:00, 61.83it/s] 98%|█████████▊| 107/109 [00:02<00:00, 29.90it/s]110it [00:02, 48.81it/s]                         
Iter:   1090,  Train Loss: 0.00013,  Train Acc: 100.00%,  Val Loss:   0.6,  Val Acc: 87.98%,  Time: 0:00:23 
Epoch [11/20]
  0%|          | 0/109 [00:00<?, ?it/s]  6%|▋         | 7/109 [00:00<00:01, 64.10it/s] 13%|█▎        | 14/109 [00:00<00:01, 59.94it/s] 19%|█▉        | 21/109 [00:00<00:01, 62.05it/s] 26%|██▌       | 28/109 [00:00<00:01, 59.29it/s] 31%|███       | 34/109 [00:00<00:01, 58.58it/s] 38%|███▊      | 41/109 [00:00<00:01, 60.33it/s] 44%|████▍     | 48/109 [00:00<00:01, 60.25it/s] 50%|█████     | 55/109 [00:00<00:00, 59.58it/s] 56%|█████▌    | 61/109 [00:01<00:00, 57.93it/s] 62%|██████▏   | 68/109 [00:01<00:00, 58.90it/s] 69%|██████▉   | 75/109 [00:01<00:00, 59.49it/s] 74%|███████▍  | 81/109 [00:01<00:00, 59.31it/s] 80%|███████▉  | 87/109 [00:01<00:00, 59.15it/s] 85%|████████▌ | 93/109 [00:01<00:00, 58.35it/s] 92%|█████████▏| 100/109 [00:02<00:00, 29.92it/s] 97%|█████████▋| 106/109 [00:02<00:00, 34.69it/s]110it [00:02, 49.76it/s]                         
Iter:   1199,  Train Loss: 0.00013,  Train Acc: 100.00%,  Val Loss:  0.61,  Val Acc: 88.18%,  Time: 0:00:25 
Epoch [12/20]
  0%|          | 0/109 [00:00<?, ?it/s]  0%|          | 0/109 [00:00<?, ?it/s]
No optimization for a long time in last 11 epochs, auto-stopping...
Test Loss:  0.25,  Test Acc: 89.73%
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

           1     0.8797    0.9156    0.8973       735
           2     0.9155    0.8796    0.8972       764

    accuracy                         0.8973      1499
   macro avg     0.8976    0.8976    0.8973      1499
weighted avg     0.8980    0.8973    0.8973      1499

Confusion Matrix...
[[673  62]
 [ 92 672]]
Time usage: 0:00:00
