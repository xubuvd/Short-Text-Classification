model               : TextRCNN
embedding           : random
dataset             : TREC
word                : True
pad                 : 20
<models.TextRCNN.Config object at 0x7efaea4a8ad0>
Loading data...
Vocab size: 8466
0it [00:00, ?it/s]5452it [00:00, 102513.35it/s]
0it [00:00, ?it/s]500it [00:00, 183429.72it/s]
0it [00:00, ?it/s]500it [00:00, 175215.31it/s]
/home/pangwei/.conda/envs/vd/lib/python3.7/site-packages/torch/nn/modules/rnn.py:65: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.2 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
Time usage: 0:00:00
<bound method Module.parameters of Model(
  (embedding): Embedding(8466, 300, padding_idx=8465)
  (lstm): LSTM(300, 300, batch_first=True, dropout=0.2, bidirectional=True)
  (maxpool): MaxPool1d(kernel_size=20, stride=20, padding=0, dilation=1, ceil_mode=False)
  (fc): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=900, out_features=6, bias=True)
  )
)>
Epoch [1/20]
  0%|          | 0/85 [00:00<?, ?it/s]  1%|          | 1/85 [00:00<00:12,  6.90it/s] 12%|█▏        | 10/85 [00:00<00:01, 47.06it/s] 22%|██▏       | 19/85 [00:00<00:01, 62.41it/s] 35%|███▌      | 30/85 [00:00<00:00, 76.27it/s] 47%|████▋     | 40/85 [00:00<00:00, 82.14it/s] 58%|█████▊    | 49/85 [00:00<00:00, 82.71it/s] 69%|██████▉   | 59/85 [00:00<00:00, 83.37it/s] 80%|████████  | 68/85 [00:00<00:00, 83.43it/s] 91%|█████████ | 77/85 [00:01<00:00, 83.55it/s]86it [00:01, 62.25it/s]                        86it [00:01, 68.94it/s]
Iter:      0,  Train Loss:   3.3,  Train Acc: 15.62%,  Val Loss:   2.8,  Val Acc: 26.20%,  Time: 0:00:00 *
Iter:     85,  Train Loss:   1.1,  Train Acc: 75.00%,  Val Loss:  0.44,  Val Acc: 83.20%,  Time: 0:00:01 *
Epoch [2/20]
  0%|          | 0/85 [00:00<?, ?it/s] 11%|█         | 9/85 [00:00<00:00, 79.25it/s] 21%|██        | 18/85 [00:00<00:00, 84.02it/s] 33%|███▎      | 28/85 [00:00<00:00, 90.59it/s] 45%|████▍     | 38/85 [00:00<00:00, 91.13it/s] 56%|█████▋    | 48/85 [00:00<00:00, 93.90it/s] 68%|██████▊   | 58/85 [00:00<00:00, 92.10it/s] 80%|████████  | 68/85 [00:00<00:00, 91.25it/s] 92%|█████████▏| 78/85 [00:00<00:00, 93.85it/s]86it [00:00, 86.15it/s]                        
Iter:    170,  Train Loss:   0.2,  Train Acc: 93.75%,  Val Loss:  0.53,  Val Acc: 84.40%,  Time: 0:00:02 
Epoch [3/20]
  0%|          | 0/85 [00:00<?, ?it/s] 12%|█▏        | 10/85 [00:00<00:00, 91.88it/s] 24%|██▎       | 20/85 [00:00<00:00, 81.24it/s] 34%|███▍      | 29/85 [00:00<00:00, 80.97it/s] 45%|████▍     | 38/85 [00:00<00:00, 81.55it/s] 58%|█████▊    | 49/85 [00:00<00:00, 89.18it/s] 69%|██████▉   | 59/85 [00:00<00:00, 90.98it/s] 81%|████████  | 69/85 [00:00<00:00, 89.96it/s] 93%|█████████▎| 79/85 [00:00<00:00, 88.69it/s]86it [00:01, 78.67it/s]                        
Iter:    255,  Train Loss: 0.049,  Train Acc: 98.44%,  Val Loss:  0.44,  Val Acc: 86.20%,  Time: 0:00:03 *
Epoch [4/20]
  0%|          | 0/85 [00:00<?, ?it/s] 12%|█▏        | 10/85 [00:00<00:00, 94.86it/s] 24%|██▎       | 20/85 [00:00<00:00, 87.95it/s] 35%|███▌      | 30/85 [00:00<00:00, 90.80it/s] 47%|████▋     | 40/85 [00:00<00:00, 91.64it/s] 60%|██████    | 51/85 [00:00<00:00, 95.30it/s] 72%|███████▏  | 61/85 [00:00<00:00, 95.11it/s] 84%|████████▎ | 71/85 [00:00<00:00, 94.18it/s] 95%|█████████▌| 81/85 [00:00<00:00, 95.18it/s]86it [00:00, 88.40it/s]                        
Iter:    340,  Train Loss: 0.038,  Train Acc: 98.44%,  Val Loss:  0.57,  Val Acc: 85.40%,  Time: 0:00:04 
Epoch [5/20]
  0%|          | 0/85 [00:00<?, ?it/s] 12%|█▏        | 10/85 [00:00<00:00, 89.16it/s] 24%|██▎       | 20/85 [00:00<00:00, 92.62it/s] 35%|███▌      | 30/85 [00:00<00:00, 90.30it/s] 48%|████▊     | 41/85 [00:00<00:00, 95.52it/s] 60%|██████    | 51/85 [00:00<00:00, 94.08it/s] 72%|███████▏  | 61/85 [00:00<00:00, 90.93it/s] 84%|████████▎ | 71/85 [00:00<00:00, 90.69it/s] 95%|█████████▌| 81/85 [00:00<00:00, 89.90it/s]86it [00:01, 85.03it/s]                        
Iter:    425,  Train Loss: 0.0029,  Train Acc: 100.00%,  Val Loss:  0.45,  Val Acc: 87.40%,  Time: 0:00:05 
Epoch [6/20]
  0%|          | 0/85 [00:00<?, ?it/s] 12%|█▏        | 10/85 [00:00<00:00, 94.85it/s] 24%|██▎       | 20/85 [00:00<00:00, 92.44it/s] 35%|███▌      | 30/85 [00:00<00:00, 88.44it/s] 46%|████▌     | 39/85 [00:00<00:00, 87.22it/s] 59%|█████▉    | 50/85 [00:00<00:00, 91.10it/s] 71%|███████   | 60/85 [00:00<00:00, 92.88it/s] 82%|████████▏ | 70/85 [00:00<00:00, 91.46it/s] 94%|█████████▍| 80/85 [00:00<00:00, 90.44it/s]86it [00:01, 84.16it/s]                        
Iter:    510,  Train Loss: 0.00092,  Train Acc: 100.00%,  Val Loss:  0.53,  Val Acc: 86.20%,  Time: 0:00:06 
Epoch [7/20]
  0%|          | 0/85 [00:00<?, ?it/s] 12%|█▏        | 10/85 [00:00<00:00, 96.60it/s] 24%|██▎       | 20/85 [00:00<00:00, 92.76it/s] 35%|███▌      | 30/85 [00:00<00:00, 90.03it/s] 47%|████▋     | 40/85 [00:00<00:00, 88.54it/s] 58%|█████▊    | 49/85 [00:00<00:00, 88.21it/s] 69%|██████▉   | 59/85 [00:00<00:00, 90.64it/s] 81%|████████  | 69/85 [00:00<00:00, 89.69it/s] 93%|█████████▎| 79/85 [00:00<00:00, 89.83it/s]86it [00:01, 83.96it/s]                        
Iter:    595,  Train Loss: 0.00036,  Train Acc: 100.00%,  Val Loss:  0.54,  Val Acc: 87.00%,  Time: 0:00:07 
Epoch [8/20]
  0%|          | 0/85 [00:00<?, ?it/s]  9%|▉         | 8/85 [00:00<00:00, 78.04it/s] 21%|██        | 18/85 [00:00<00:00, 89.03it/s] 32%|███▏      | 27/85 [00:00<00:00, 87.45it/s] 44%|████▎     | 37/85 [00:00<00:00, 91.54it/s] 55%|█████▌    | 47/85 [00:00<00:00, 90.60it/s] 67%|██████▋   | 57/85 [00:00<00:00, 89.00it/s] 78%|███████▊  | 66/85 [00:00<00:00, 88.70it/s] 89%|████████▉ | 76/85 [00:00<00:00, 89.91it/s]100%|██████████| 85/85 [00:01<00:00, 76.95it/s]86it [00:01, 84.24it/s]                        
Iter:    680,  Train Loss: 0.001,  Train Acc: 100.00%,  Val Loss:  0.53,  Val Acc: 86.60%,  Time: 0:00:08 
Epoch [9/20]
  0%|          | 0/85 [00:00<?, ?it/s] 12%|█▏        | 10/85 [00:00<00:00, 93.85it/s] 24%|██▎       | 20/85 [00:00<00:00, 95.90it/s] 35%|███▌      | 30/85 [00:00<00:00, 93.30it/s] 47%|████▋     | 40/85 [00:00<00:00, 91.66it/s] 59%|█████▉    | 50/85 [00:00<00:00, 89.18it/s] 69%|██████▉   | 59/85 [00:00<00:00, 88.36it/s] 80%|████████  | 68/85 [00:00<00:00, 84.76it/s] 91%|█████████ | 77/85 [00:00<00:00, 85.75it/s]86it [00:01, 72.29it/s]                        86it [00:01, 82.66it/s]
Iter:    765,  Train Loss: 0.00066,  Train Acc: 100.00%,  Val Loss:  0.56,  Val Acc: 86.80%,  Time: 0:00:09 
Epoch [10/20]
  0%|          | 0/85 [00:00<?, ?it/s] 12%|█▏        | 10/85 [00:00<00:00, 94.22it/s] 24%|██▎       | 20/85 [00:00<00:00, 92.83it/s] 35%|███▌      | 30/85 [00:00<00:00, 91.05it/s] 47%|████▋     | 40/85 [00:00<00:00, 90.34it/s] 59%|█████▉    | 50/85 [00:00<00:00, 91.51it/s] 71%|███████   | 60/85 [00:00<00:00, 93.41it/s] 82%|████████▏ | 70/85 [00:00<00:00, 93.06it/s] 94%|█████████▍| 80/85 [00:00<00:00, 82.35it/s]86it [00:00, 88.82it/s]                        
Iter:    850,  Train Loss: 0.00012,  Train Acc: 100.00%,  Val Loss:  0.58,  Val Acc: 87.00%,  Time: 0:00:10 
Epoch [11/20]
  0%|          | 0/85 [00:00<?, ?it/s] 12%|█▏        | 10/85 [00:00<00:00, 89.53it/s] 24%|██▎       | 20/85 [00:00<00:00, 93.46it/s] 35%|███▌      | 30/85 [00:00<00:00, 93.43it/s] 47%|████▋     | 40/85 [00:00<00:00, 92.88it/s] 59%|█████▉    | 50/85 [00:00<00:00, 93.88it/s] 71%|███████   | 60/85 [00:00<00:00, 92.35it/s] 82%|████████▏ | 70/85 [00:00<00:00, 90.44it/s] 94%|█████████▍| 80/85 [00:00<00:00, 81.00it/s]86it [00:00, 86.66it/s]                        
Iter:    935,  Train Loss: 0.00018,  Train Acc: 100.00%,  Val Loss:  0.57,  Val Acc: 86.60%,  Time: 0:00:11 
Epoch [12/20]
  0%|          | 0/85 [00:00<?, ?it/s] 11%|█         | 9/85 [00:00<00:00, 88.58it/s] 21%|██        | 18/85 [00:00<00:00, 81.48it/s] 32%|███▏      | 27/85 [00:00<00:00, 81.94it/s] 42%|████▏     | 36/85 [00:00<00:00, 83.09it/s] 54%|█████▍    | 46/85 [00:00<00:00, 86.87it/s] 66%|██████▌   | 56/85 [00:00<00:00, 89.26it/s] 78%|███████▊  | 66/85 [00:00<00:00, 89.77it/s] 88%|████████▊ | 75/85 [00:00<00:00, 76.12it/s]100%|██████████| 85/85 [00:01<00:00, 80.07it/s]86it [00:01, 83.12it/s]                        
Iter:   1020,  Train Loss: 0.00022,  Train Acc: 100.00%,  Val Loss:  0.56,  Val Acc: 87.20%,  Time: 0:00:12 
Epoch [13/20]
  0%|          | 0/85 [00:00<?, ?it/s] 11%|█         | 9/85 [00:00<00:00, 89.48it/s] 21%|██        | 18/85 [00:00<00:00, 81.69it/s] 32%|███▏      | 27/85 [00:00<00:00, 83.46it/s] 42%|████▏     | 36/85 [00:00<00:00, 78.76it/s] 53%|█████▎    | 45/85 [00:00<00:00, 80.98it/s] 65%|██████▍   | 55/85 [00:00<00:00, 84.31it/s] 75%|███████▌  | 64/85 [00:00<00:00, 84.72it/s] 86%|████████▌ | 73/85 [00:00<00:00, 85.79it/s] 96%|█████████▋| 82/85 [00:01<00:00, 76.83it/s]86it [00:01, 80.97it/s]                        
Iter:   1105,  Train Loss: 0.00022,  Train Acc: 100.00%,  Val Loss:  0.57,  Val Acc: 87.00%,  Time: 0:00:13 
Epoch [14/20]
  0%|          | 0/85 [00:00<?, ?it/s]  0%|          | 0/85 [00:00<?, ?it/s]
No optimization for a long time in last 11 epochs, auto-stopping...
Test Loss:  0.44,  Test Acc: 86.20%
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

           1     0.7895    0.9783    0.8738       138
           2     0.7857    0.7021    0.7416        94
           3     1.0000    0.7778    0.8750         9
           4     0.8923    0.8923    0.8923        65
           5     0.9296    0.8148    0.8684        81
           6     0.9706    0.8761    0.9209       113

    accuracy                         0.8620       500
   macro avg     0.8946    0.8402    0.8620       500
weighted avg     0.8696    0.8620    0.8611       500

Confusion Matrix...
[[135   3   0   0   0   0]
 [ 18  66   0   7   2   1]
 [  2   0   7   0   0   0]
 [  1   5   0  58   1   0]
 [  4   9   0   0  66   2]
 [ 11   1   0   0   2  99]]
Time usage: 0:00:00
